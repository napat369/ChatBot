# æ·±æ€æ™ºèŠå¹³å° - éƒ¨ç½²æ“ä½œæŒ‡å—

## ğŸš€ éƒ¨ç½²æ–¹å¼é€‰æ‹©

### æ–¹å¼ä¸€ï¼šè‡ªåŠ¨åŒ–éƒ¨ç½²ï¼ˆæ¨èï¼‰
ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬ä¸€é”®éƒ¨ç½²åˆ°LinuxæœåŠ¡å™¨

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²
æ‰‹åŠ¨ä¸Šä¼ æ–‡ä»¶å¹¶é…ç½®æœåŠ¡å™¨

---

## ğŸ“¦ æ–¹å¼ä¸€ï¼šè‡ªåŠ¨åŒ–éƒ¨ç½²

### 1. å‡†å¤‡å·¥ä½œ

åœ¨Windowsæœ¬åœ°ç¡®ä¿å·²å®‰è£…ï¼š
- Git Bash æˆ– WSL
- SSHå®¢æˆ·ç«¯

### 2. æ‰§è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
chmod +x deploy-to-server.sh

# éƒ¨ç½²åˆ°æœåŠ¡å™¨
./deploy-to-server.sh æœåŠ¡å™¨IP ç”¨æˆ·å [å¯é€‰:è¿œç¨‹è·¯å¾„]

# ç¤ºä¾‹
./deploy-to-server.sh 192.168.1.100 ubuntu
./deploy-to-server.sh 123.456.789.10 root /opt/chatbot
```

### 3. é…ç½®ç¯å¢ƒå˜é‡

éƒ¨ç½²å®Œæˆåï¼ŒSSHè¿æ¥åˆ°æœåŠ¡å™¨ï¼š

```bash
ssh ubuntu@192.168.1.100
cd /home/ubuntu/chatbot-system

# ç¼–è¾‘ç¯å¢ƒå˜é‡
nano .env.production.local
```

é…ç½®ä»¥ä¸‹å…³é”®å‚æ•°ï¼š
```bash
DEEPSEEK_API_KEY=sk-your-api-key-here
MYSQL_ROOT_PASSWORD=your_secure_password
MYSQL_PASSWORD=another_secure_password
DOMAIN_NAME=your-domain.com  # å¦‚æœæœ‰åŸŸå
```

### 4. å¯åŠ¨æœåŠ¡

```bash
./deploy.sh start
```

---

## ğŸ”§ æ–¹å¼äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²

### 1. å‡†å¤‡æœåŠ¡å™¨æ–‡ä»¶

#### æ–¹æ³•Aï¼šä½¿ç”¨SCPä¸Šä¼ 
```bash
# å‹ç¼©é¡¹ç›®æ–‡ä»¶
tar --exclude='node_modules' --exclude='.git' --exclude='*.log' -czf chatbot.tar.gz .

# ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp chatbot.tar.gz ubuntu@192.168.1.100:/home/ubuntu/

# SSHè¿æ¥æœåŠ¡å™¨
ssh ubuntu@192.168.1.100

# è§£å‹æ–‡ä»¶
cd /home/ubuntu
tar -xzf chatbot.tar.gz
mv chatbot-system /home/ubuntu/chatbot-system
cd chatbot-system
```

#### æ–¹æ³•Bï¼šä½¿ç”¨Gitå…‹éš†
```bash
# åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ
git clone https://github.com/your-username/chatbot-system.git
cd chatbot-system
```

#### æ–¹æ³•Cï¼šä½¿ç”¨FTPå·¥å…·
ä½¿ç”¨FileZillaã€WinSCPç­‰å·¥å…·ä¸Šä¼ ä»¥ä¸‹æ–‡ä»¶ï¼š
- `docker-compose.yml`
- `deploy.sh`
- `.env.production`
- `backend/` ç›®å½•
- `frontend/` ç›®å½•
- `deploy/` ç›®å½•

### 2. å®‰è£…Dockerç¯å¢ƒ

```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update

# å®‰è£…Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo usermod -aG docker $USER

# å®‰è£…Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose

# é‡æ–°ç™»å½•ä»¥åº”ç”¨ç”¨æˆ·ç»„å˜æ›´
exit
# é‡æ–°SSHè¿æ¥
```

### 3. é…ç½®ç¯å¢ƒå˜é‡

```bash
cd /path/to/chatbot-system
cp .env.production .env.production.local
nano .env.production.local
```

### 4. å¯åŠ¨æœåŠ¡

```bash
chmod +x deploy.sh
./deploy.sh start
```

---

## ğŸŒ åŸŸåç»‘å®šé…ç½®

### 1. DNSé…ç½®

åœ¨åŸŸåæœåŠ¡å•†æ§åˆ¶å°æ·»åŠ Aè®°å½•ï¼š
```
ç±»å‹: A
ä¸»æœºè®°å½•: @ æˆ– www
è®°å½•å€¼: ä½ çš„æœåŠ¡å™¨IP
TTL: 600
```

### 2. é…ç½®SSLè¯ä¹¦

```bash
# ç¼–è¾‘ç¯å¢ƒå˜é‡
nano .env.production.local

# æ·»åŠ åŸŸåé…ç½®
DOMAIN_NAME=your-domain.com
SSL_EMAIL=your-email@example.com

# ç”³è¯·SSLè¯ä¹¦
./deploy.sh ssl
```

### 3. æ›´æ–°Nginxé…ç½®

SSLè¯ä¹¦ç”³è¯·æˆåŠŸåï¼Œé‡å¯æœåŠ¡ï¼š
```bash
./deploy.sh restart
```

---

## ğŸ“‹ å¸¸ç”¨ç®¡ç†å‘½ä»¤

### æœåŠ¡ç®¡ç†
```bash
./deploy.sh start     # å¯åŠ¨æœåŠ¡
./deploy.sh stop      # åœæ­¢æœåŠ¡
./deploy.sh restart   # é‡å¯æœåŠ¡
./deploy.sh status    # æŸ¥çœ‹çŠ¶æ€
```

### æ—¥å¿—æŸ¥çœ‹
```bash
./deploy.sh logs              # æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—
./deploy.sh logs backend      # æŸ¥çœ‹åç«¯æ—¥å¿—
./deploy.sh logs frontend     # æŸ¥çœ‹å‰ç«¯æ—¥å¿—
./deploy.sh logs mysql        # æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—
```

### ç»´æŠ¤æ“ä½œ
```bash
./deploy.sh update    # æ›´æ–°æœåŠ¡
./deploy.sh backup    # å¤‡ä»½æ•°æ®
```

---

## ğŸ” æ•…éšœæ’é™¤

### 1. ç«¯å£æ£€æŸ¥
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
sudo netstat -tlnp | grep :80
sudo netstat -tlnp | grep :443

# å¼€æ”¾é˜²ç«å¢™ç«¯å£
sudo ufw allow 80
sudo ufw allow 443
sudo ufw enable
```

### 2. Dockeré—®é¢˜
```bash
# æ£€æŸ¥DockerçŠ¶æ€
sudo systemctl status docker

# é‡å¯Docker
sudo systemctl restart docker

# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps -a
```

### 3. æƒé™é—®é¢˜
```bash
# ç¡®ä¿ç”¨æˆ·åœ¨dockerç»„ä¸­
sudo usermod -aG docker $USER

# è®¾ç½®æ–‡ä»¶æƒé™
chmod +x deploy.sh
sudo chown -R $USER:$USER /path/to/chatbot-system
```

### 4. å†…å­˜ä¸è¶³
```bash
# æ£€æŸ¥ç³»ç»Ÿèµ„æº
free -h
df -h

# æ¸…ç†Dockerèµ„æº
docker system prune -f
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. æœåŠ¡å™¨é…ç½®
- **æœ€ä½é…ç½®**ï¼š2æ ¸CPUï¼Œ4GBå†…å­˜ï¼Œ20GBå­˜å‚¨
- **æ¨èé…ç½®**ï¼š4æ ¸CPUï¼Œ8GBå†…å­˜ï¼Œ50GBå­˜å‚¨

### 2. æ•°æ®åº“ä¼˜åŒ–
```bash
# ç¼–è¾‘MySQLé…ç½®
nano deploy/mysql/my.cnf

# æ·»åŠ ä¼˜åŒ–å‚æ•°
[mysqld]
innodb_buffer_pool_size = 1G
max_connections = 200
```

### 3. ç¼“å­˜é…ç½®
```bash
# Rediså†…å­˜é™åˆ¶
# åœ¨docker-compose.ymlä¸­æ·»åŠ 
command: redis-server --maxmemory 512mb --maxmemory-policy allkeys-lru
```

---

## ğŸ” å®‰å…¨å»ºè®®

### 1. ä¿®æ”¹é»˜è®¤å¯†ç 
```bash
# ç”Ÿæˆå¼ºå¯†ç 
openssl rand -base64 32

# æ›´æ–°ç¯å¢ƒå˜é‡ä¸­çš„å¯†ç 
nano .env.production.local
```

### 2. é…ç½®é˜²ç«å¢™
```bash
# åªå¼€æ”¾å¿…è¦ç«¯å£
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow ssh
sudo ufw allow 80
sudo ufw allow 443
sudo ufw enable
```

### 3. å®šæœŸå¤‡ä»½
```bash
# è®¾ç½®å®šæ—¶å¤‡ä»½
crontab -e

# æ·»åŠ å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½ï¼‰
0 2 * * * /path/to/chatbot-system/deploy.sh backup
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ’æŸ¥ï¼š

1. æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š`./deploy.sh status`
2. æŸ¥çœ‹é”™è¯¯æ—¥å¿—ï¼š`./deploy.sh logs`
3. æ£€æŸ¥ç³»ç»Ÿèµ„æºï¼š`free -h && df -h`
4. éªŒè¯ç½‘ç»œè¿æ¥ï¼š`curl -I http://localhost`

æ›´å¤šå¸®åŠ©ï¼š`./deploy.sh help`